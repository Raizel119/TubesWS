<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{{ book.Judul }} - Bookara</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}" />
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet"
     href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&icon_names=search" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>

<body>
<header class="navbar">
    <div class="container">
        <div class="navbar-left">
            <a href="/" class="navbar-brand">
                <img src="{{ url_for('static', filename='img/logo.png') }}" alt="Bookara Logo">
            </a>

            <div class="dropdown">
                <a href="/" class="nav-link">Kategori <span class="arrow"></span></a>
                <div class="dropdown-content">
                    {% for cat in all_categories %}
                        <a href="/?filter=cat_{{ cat }}">{{ cat }}</a>
                    {% endfor %}
                </div>
            </div>
        </div>

        <div class="navbar-center">
            <div class="search-bar-container">
                <form action="/" method="GET" class="search-bar" id="search-form">
                    <span class="material-symbols-outlined">search</span>
                    <input type="text" name="query" id="search-input" placeholder="Cari Judul Buku atau Penulis" autocomplete="off">
                </form>

                <div class="search-history" id="search-history-dropdown">
                    <div class="history-header">
                        <h3>Riwayat Pencarian</h3>
                        <button type="button" class="clear-history-btn" id="clear-history">Hapus Semua</button>
                    </div>
                    <ul class="history-list" id="history-list"></ul>
                </div>
            </div>
        </div>

        <nav class="navbar-right">
            <a href="/" class="nav-link">Home</a>
            <a href="#" class="nav-link">About Us</a>
            <a href="#" class="nav-link">Contact</a>
        </nav>
    </div>
</header>

<main class="main-content container">

    <!-- ======================== -->
    <!--       BREADCRUMB         -->
    <!-- ======================== -->
    <nav class="breadcrumb">
        <a href="/">Home</a> &gt;
        <a href="/?filter=cat_{{ book.KategoriUtama }}">{{ book.KategoriUtama }}</a>

        {% if book.Subkategori1 and book.Subkategori1 != "Tidak ditemukan" %}
        &gt; <a href="/?filter=sub1_{{ book.Subkategori1 }}">{{ book.Subkategori1 }}</a>
        {% endif %}

        {% if book.Subkategori2 and book.Subkategori2 != "Tidak ditemukan" %}
        &gt; <a href="/?filter=sub2_{{ book.Subkategori2 }}">{{ book.Subkategori2 }}</a>
        {% endif %}

        {% if book.Subkategori3 and book.Subkategori3 != "Tidak ditemukan" %}
        &gt; <a href="/?filter=sub3_{{ book.Subkategori3 }}">{{ book.Subkategori3 }}</a>
        {% endif %}

        &gt; <span>{{ book.Judul }}</span>
    </nav>

    <!-- ======================== -->
    <!--      BOOK DETAILS        -->
    <!-- ======================== -->
    <div class="book-detail-card">
        <div class="card-image">
            {% if book.Gambar and book.Gambar != 'Tidak ditemukan' and book.Gambar|length > 5 %}
                <img src="{{ book.Gambar }}" 
                    alt="{{ book.Judul }}"
                    onerror=`this.onerror=null; this.src="{{ url_for("static", filename="img/placeholder.jpg") }}";`>
            {% else %}
                <img src="{{ url_for('static', filename='img/placeholder.jpg') }}" 
                    alt="Gambar Tidak Tersedia">
            {% endif %}
        </div>

        <div class="book-detail-info">

            <p class="detail-author">{{ book.Penulis }}</p>
            <h1>{{ book.Judul }}</h1>

            <p class="detail-price">{{ book.Harga }}</p>

            <div class="detail-info-block">
                <h4>Format Buku</h4>
                <p>{{ book.Format or 'Soft Cover' }}</p>
            </div>

            <div class="detail-info-block">
                <h4>Deskripsi</h4>
                <p class="detail-description">{{ book.Deskripsi }}</p>
            </div>

            <div class="detail-info-block">
                <h4>Detail Buku</h4>

                <div class="detail-specs-grid">
                    <div class="jd">
                        <p><strong>Penerbit</strong></p>
                        <p>{{ book.Penerbit }}</p>
                    </div>

                    <div class="jd">
                        <p><strong>Tanggal Terbit</strong></p>
                        <p>{{ book.TanggalTerbit }}</p>
                    </div>

                    <div class="jd">
                        <p><strong>ISBN</strong></p>
                        <p>{{ book.ISBN }}</p>
                    </div>

                    <div class="jd">
                        <p><strong>Halaman</strong></p>
                        <p>{{ book.Halaman }}</p>
                    </div>

                    <div class="jd">
                        <p><strong>Bahasa</strong></p>
                        <p>{{ book.Bahasa }}</p>
                    </div>

                    <div class="jd">
                        <p><strong>Panjang</strong></p>
                        <p>{{ book.Panjang }}</p>
                    </div>

                    <div class="jd">
                        <p><strong>Lebar</strong></p>
                        <p>{{ book.Lebar }}</p>
                    </div>

                    <div class="jd">
                        <p><strong>Berat</strong></p>
                        <p>{{ book.Berat }}</p>
                    </div>

                    <div class="jd">
                        <p><strong>Link Gramedia</strong></p>
                        <p>
                            {% if book.URL and book.URL != '#' %}
                                <a href="{{ book.URL }}" target="_blank" style="color: #007bff; text-decoration: underline;">
                                    Buka Website <i class="fas fa-external-link-alt" style="font-size: 0.8em;"></i>
                                </a>
                            {% else %}
                                -
                            {% endif %}
                        </p>
                    </div>

                </div>
            </div>

        </div>
    </div>
</main>

<footer class="footer">
    <div class="footer-top">
        <div class="footer-logo">
            <img src="{{ url_for('static', filename='img/logo.png') }}" alt="Bookara" />
        </div>
        <div class="footer-tagline">
            Search Smarter. Read Better.
        </div>
    </div>

    <div class="footer-container">
        <div class="footer-column">
            <h3>Company</h3>
            <a href="#">Home</a>
            <a href="#">About Us</a>
            <a href="#">Kategori</a>
            <a href="#">Contact</a>
        </div>

        <div class="footer-column">
            <h3>Support</h3>
            <a href="#">Help Center</a>
            <a href="#">How It Works</a>
            <a href="#">Report an Issue</a>
        </div>

        <div class="footer-column">
            <h3>Legal</h3>
            <a href="#">Privacy Policy</a>
            <a href="#">Terms of Service</a>
            <a href="#">Cookie Policy</a>
            <a href="#">Content Guidelines</a>
        </div>

        <div class="footer-column">
            <h3>Contact Information</h3>
            <a href="#">Email Support</a>
            <a href="#">Business Inquiries</a>

            <p style="margin-top:10px; font-weight:600">Social Media Links:</p>
            <div class="social-icons">
                <i class="fab fa-instagram"></i>
                <i class="fab fa-x-twitter"></i>
                <i class="fab fa-facebook"></i>
                <i class="fab fa-linkedin"></i>
            </div>
        </div>
    </div>

    <div class="footer-bottom">
        Â© 2025 Bookora. All rights reserved.
    </div>
</footer>


<!-- ===================== -->
<!-- SEARCH HISTORY SCRIPT -->
<!-- ===================== -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    const searchForm = document.getElementById('search-form');
    const searchInput = document.getElementById('search-input');
    const historyDropdown = document.getElementById('search-history-dropdown');
    const historyList = document.getElementById('history-list');
    const clearHistoryBtn = document.getElementById('clear-history');

    let searchHistory = JSON.parse(localStorage.getItem('searchHistory')) || [];

    function renderHistory() {
        historyList.innerHTML = '';
        if (searchHistory.length === 0) {
            historyList.innerHTML = '<li class="history-empty">Belum ada riwayat pencarian</li>';
            clearHistoryBtn.style.display = 'none';
            return;
        }

        clearHistoryBtn.style.display = 'block';
        searchHistory.forEach((term, index) => {
            const li = document.createElement('li');
            li.innerHTML = `
                <i class="fas fa-history"></i>
                <span class="history-term">${term}</span>
                <button type="button" class="delete-item-btn" data-index="${index}">&times;</button>
            `;
            historyList.appendChild(li);
        });
    }

    searchInput.addEventListener('focus', () => {
        renderHistory();
        historyDropdown.style.display = 'block';
    });

    document.addEventListener('click', (e) => {
        if (!e.target.closest('.search-bar-container')) {
            historyDropdown.style.display = 'none';
        }
    });

    searchForm.addEventListener('submit', () => {
        const searchTerm = searchInput.value.trim();
        if (searchTerm) {
            if (searchHistory.includes(searchTerm)) {
                searchHistory = searchHistory.filter(t => t !== searchTerm);
            }
            searchHistory.unshift(searchTerm);
            searchHistory = searchHistory.slice(0, 5);
            localStorage.setItem('searchHistory', JSON.stringify(searchHistory));
        }
    });

    clearHistoryBtn.addEventListener('click', () => {
        searchHistory = [];
        localStorage.setItem('searchHistory', JSON.stringify(searchHistory));
        renderHistory();
    });

    historyList.addEventListener('click', (e) => {
        if (e.target.classList.contains('delete-item-btn')) {
            e.stopPropagation();
            const index = e.target.getAttribute('data-index');
            searchHistory.splice(index, 1);
            localStorage.setItem('searchHistory', JSON.stringify(searchHistory));
            renderHistory();
        }

        if (e.target.classList.contains('history-term')) {
            searchInput.value = e.target.textContent;
            searchForm.submit();
        }
    });
});
</script>

</body>
</html>
